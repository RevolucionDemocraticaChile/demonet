<div class="row">
  <div class="col-lg-10 col-lg-offset-1">
    <h1><%= t(:users).titleize %></h1>

    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th><%= t(:name).titleize %></th>
          <th><%= t(:email).titleize %></th>
          <th><%= t(:username).titleize %></th>
          <% if current_user.admin? %>
            <th class="text-center"><%= t(:recent_attendances).titleize %></th>
            <th class="text-center"><%= t(:active).titleize %>?</th>
            <th colspan="2"></th>
          <% end %>
        </tr>
      </thead>

      <tbody>
        <% @users.each do |user| %>
          <tr>
            <td><%= link_to user.name, user %></td>
            <td><%= user.email %></td>
            <td><%= user.username %></td>
            <% if current_user.admin? %>
              <td class="text-center">
                <%= user.meetings.where(date: (DateTime.now-6.months)..(DateTime.now)).count %>
              </td>
              <td class="text-center">
                <% if user.meetings.where(date: (DateTime.now-6.months)..(DateTime.now)).count >= 6 %>
                  <span class="glyphicon glyphicon-ok"></span>
                <% end %>
              </td>
              <td class="text-center">
                <%= link_to t(:edit).titleize, edit_user_path(user), class: "btn btn-info" %>
              </td>
              <td class="text-center">
                <%= link_to t(:destroy).titleize, user, method: :delete, data: { confirm: t(:are_you_sure).titleize }, class: "btn btn-danger" %>
              </td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>

    <% if can? :new, User %>
      <%= link_to t(:new_user).titleize, new_user_path, class: "btn btn-primary" %>
    <% end %>

  </div>
</div>
